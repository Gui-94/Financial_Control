import"./modulepreload-polyfill-B5Qt9EMX.js";const b=document.getElementById("formGasto"),v=document.getElementById("listaGastos"),y=document.getElementById("resumo"),h=document.getElementById("graficoGastos").getContext("2d"),w=document.getElementById("filtroMes"),B=document.getElementById("btnFiltrar");let d;const i={};function S(e){if(i[e])return i[e];const t=Math.floor(Math.random()*200+30),o=Math.floor(Math.random()*200+30),s=Math.floor(Math.random()*200+30);return i[e]=`rgba(${t},${o},${s},0.7)`,i[e]}let n=JSON.parse(localStorage.getItem("gastos"))||[];function m(){localStorage.setItem("gastos",JSON.stringify(n))}function E(e=n){const t={};e.forEach(r=>{const a=r.categoria||"Sem categoria";t[a]||(t[a]=0),t[a]+=r.valor});const o=e.reduce((r,a)=>r+a.valor,0);y.innerHTML=`
    <p>Total: <b>R$ ${o.toFixed(2)}</b></p>
    ${Object.entries(t).map(([r,a])=>`<p>ğŸ’¡ ${r}: R$ ${a.toFixed(2)}</p>`).join("")}
  `;const s=Object.keys(t),f=Object.values(t),u=s.map(S);d&&d.destroy(),d=new Chart(h,{type:"pie",data:{labels:s,datasets:[{data:f,backgroundColor:u,borderColor:"#fff",borderWidth:2}]},options:{responsive:!0,plugins:{legend:{position:"bottom",labels:{color:"#fff",font:{size:20,weight:"normal",family:"Arial, sans-serif"},generateLabels(r){const a=r.data.datasets[0];return r.data.labels.map((p,c)=>{const C=p.charAt(0).toUpperCase()+p.slice(1).toLowerCase(),g=a.backgroundColor[c];return{text:C,fillStyle:g,fontColor:g,strokeStyle:"#fff",lineWidth:1,hidden:isNaN(a.data[c])||a.data[c]===null,index:c}})}}},tooltip:{backgroundColor:"rgba(238, 225, 225, 0.85)",bodyColor:"#ffffff",titleColor:"#ffffff",bodyFont:{size:16,weight:"normal",family:"Arial, sans-serif"},titleFont:{size:18,weight:"normal",family:"Arial, sans-serif"}}},animation:{animateRotate:!0,animateScale:!0}}})}function l(e=n){v.innerHTML="",e.forEach(t=>{const o=document.createElement("li");o.innerHTML=`
      ğŸ’¸ <b>${t.descricao}</b> - R$ ${t.valor.toFixed(2)} (${t.categoria||"Sem categoria"}) - <i>${t.data}</i>
      <div class="menu-wrapper">
        <button class="menu-btn">â‹®</button>
        <div class="menu-opcoes">
          <button class="btn-editar">ğŸ–‹ï¸</button>
          <button class="btn-excluir">ğŸš®</button>
        </div>
      </div>
    `;const s=o.querySelector(".menu-wrapper");o.querySelector(".menu-btn").addEventListener("click",u=>{u.stopPropagation(),s.classList.toggle("active")}),o.querySelector(".btn-editar").onclick=()=>x(t),o.querySelector(".btn-excluir").onclick=()=>$(t),v.appendChild(o)}),E(e)}document.addEventListener("click",()=>{document.querySelectorAll(".menu-wrapper").forEach(e=>e.classList.remove("active"))});async function x(e){const{value:t}=await Swal.fire({title:"ğŸ–‹ï¸ Editar Gasto",html:`
      <input id="swal-descricao" class="swal2-input" placeholder="DescriÃ§Ã£o" value="${e.descricao}">
      <input id="swal-valor" class="swal2-input" type="number" step="0.01" placeholder="Valor" value="${e.valor}">
      <input id="swal-categoria" class="swal2-input" placeholder="Categoria" value="${e.categoria||""}">
    `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Salvar ",cancelButtonText:"Cancelar",confirmButtonColor:"#27ae60",cancelButtonColor:"#c0392b",background:"#00000000",customClass:{popup:"rounded-alert"},preConfirm:()=>({descricao:document.getElementById("swal-descricao").value,valor:parseFloat(document.getElementById("swal-valor").value),categoria:document.getElementById("swal-categoria").value})});if(t){if(!t.descricao||isNaN(t.valor)){Swal.fire({icon:"error",title:"Preencha todos os campos!",background:"#FFDAB3",customClass:{popup:"rounded-alert"}});return}e.descricao=t.descricao,e.valor=t.valor,e.categoria=t.categoria,m(),l(),Swal.fire({icon:"success",title:"Gasto atualizado!",timer:1500,showConfirmButton:!1,background:"#FFDAB3",customClass:{popup:"rounded-alert"}})}}async function $(e){(await Swal.fire({title:`Excluir "${e.descricao}"?`,text:"Essa aÃ§Ã£o nÃ£o poderÃ¡ ser desfeita!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e74c3c",cancelButtonColor:"#7f8c8d",confirmButtonText:"Sim, excluir ğŸš®",cancelButtonText:"Cancelar",background:"#00000000",customClass:{popup:"rounded-alert"}})).isConfirmed&&(n=n.filter(o=>o!==e),m(),l(),Swal.fire({icon:"success",title:"Gasto excluÃ­do!",showConfirmButton:!1,timer:1500,background:"#FF8A80",customClass:{popup:"rounded-alert"}}))}b.addEventListener("submit",e=>{e.preventDefault();const t={descricao:document.getElementById("descricao").value,valor:parseFloat(document.getElementById("valor").value),data:document.getElementById("data").value,categoria:document.getElementById("categoria").value};n.push(t),m(),b.reset(),l()});B.addEventListener("click",()=>{const e=w.value;if(!e)return Swal.fire({icon:"info",title:"Selecione um mÃªs!",confirmButtonColor:"#3498db"});const t=n.filter(o=>o.data.startsWith(e));if(t.length===0)return Swal.fire({icon:"info",title:"Nenhum gasto encontrado!",confirmButtonColor:"#2ecc71"});l(t)});l();
